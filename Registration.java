import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.util.regex.*;
import java.util.*;

public class Registration{
	JFrame frame;
	JLabel lblname,lbluname,lblemail,lblphno,lblpass,lblpass1;
	JTextField tfname,tfuname,tfemail,tfphno,tfpass,tfpass1;
	JButton btnsubmit;
	JMenuBar menubar;
	JMenu Navi,about,lkfl;
	JMenuItem miHome,miabtproject,miabtstudent,miMotif,miNimbus,miCross;
	JPanel p1,p2,p3,p4,p5,p6,p7;
	DBAccess db;
	public Registration(DBAccess db){
		this.db = db;
		initializeComponents();
		registerListeners();
		addComponentsToFrame();
		frame.setBackground(Color.lightGray);
		frame.setLayout(new GridLayout(7,1)); 
		frame.setSize(450,400);
		frame.setVisible(true);
		frame.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
	}
	public void initializeComponents(){
		menubar = new JMenuBar();
		
		Navi = new JMenu("Navigations");
		miHome = new JMenuItem("Home");
		
		about = new JMenu("About");
		miabtproject = new JMenuItem("About Project");
		miabtstudent = new JMenuItem("About Student");
		
		lkfl = new JMenu("LAF");
		miMotif = new JMenuItem("Motif");
		miNimbus = new JMenuItem("Nimbus");
		miCross = new JMenuItem("Cross Platform");
		
		frame = new JFrame("Registration");
		
		lblname = new JLabel("Name: ");
		tfname = new JTextField(10);
		
		lbluname = new JLabel("User name: ");
		tfuname = new JTextField(10);
		
		lblemail = new JLabel("Email: ");
		tfemail = new JTextField(10);
		
		lblphno = new JLabel("Phone number: ");
		tfphno = new JTextField(10);
		
		lblpass = new JLabel("Password: ");
		tfpass = new JTextField(10);
		
		lblpass1 = new JLabel("Conform Password: ");
		tfpass1 = new JTextField(10);
		
		btnsubmit = new JButton("Submit");
		
		p1 = new JPanel();
		p2 = new JPanel();
		p3 = new JPanel();
		p4 = new JPanel();
		p5 = new JPanel();
		p6 = new JPanel();
		p7 = new JPanel();
	}
	public void registerListeners(){
		tfpass.addFocusListener(new FocusAdapter(){
			public void focusLost(FocusEvent e) 
			{
				if(tfpass.getText().length()<8)
				{
					JOptionPane.showMessageDialog(frame, "Password should have at least 8 characters","WARNING", JOptionPane.WARNING_MESSAGE);
				}	
			}
		});
		btnsubmit.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent e){
				//Enter values into database;
				// getRegistered(String uname,String name,String email,String pass,int phno){
				try{
					long n = Long.parseLong(tfphno.getText());
					if(tfuname.getText().equals("")||tfname.getText().equals(null)||tfemail.getText().equals(null)||tfpass.getText().equals(null))
						JOptionPane.showMessageDialog(frame, "Enter all feilds.","WARNING", JOptionPane.WARNING_MESSAGE);
					else if(tfphno.getText().length() != 10)
						JOptionPane.showMessageDialog(frame, "Phone number is of 10 digits.","WARNING", JOptionPane.WARNING_MESSAGE);
					else if(!(tfpass.getText().equals(tfpass1.getText()))){
						JOptionPane.showMessageDialog(frame, "Re-enter the conformation password.","WARNING", JOptionPane.WARNING_MESSAGE);
						tfpass.setText(null);
						tfpass1.setText(null);
					}
					else{
						db.getRegistered(tfuname.getText(),tfname.getText(),tfemail.getText(),tfpass.getText(),n);
						JOptionPane.showMessageDialog(frame, "You have been registered","INFORMATION", JOptionPane.INFORMATION_MESSAGE);
						frame.dispose();
						new Home(db);
					}
				}
				catch(NumberFormatException ae){
					JOptionPane.showMessageDialog(frame, "Unauthorized error.\nCrash !!!\nPhone number is of 10 digits.","WARNING", JOptionPane.WARNING_MESSAGE);
				}
				// db.closeConnection();
			}
		});
		miHome.addActionListener(new ActionListener () {
			public void actionPerformed(ActionEvent e) {
				frame.dispose();
				new Home(db);
				// db.closeConnection();
			}
		});
		miabtproject.addActionListener (new ActionListener () {
			public void actionPerformed(ActionEvent e) {
				JOptionPane.showMessageDialog(frame, "Project Name: Malware Counterfeit\nDetails: This Project describes about the differenct types \nof software malwares present and their effects caused by \ntheir their presence amd ways to counterfeit it.","INFORMATION", JOptionPane.INFORMATION_MESSAGE);
			}
		});
		miabtstudent.addActionListener (new ActionListener () {
			public void actionPerformed(ActionEvent e) {
				JOptionPane.showMessageDialog(frame, "Name of Student: R. Sai Sathvik\nRoll number: 1602-20-737-035\nMain purpose of project: To implement a 1-Tier Architecture java application","INFORMATION", JOptionPane.INFORMATION_MESSAGE);
			}
		});
		miMotif.addActionListener(new ActionListener()
		{
			public void actionPerformed(ActionEvent evt) 
			{
				try{
					UIManager.setLookAndFeel("com.sun.java.swing.plaf.motif.MotifLookAndFeel");
					SwingUtilities.updateComponentTreeUI(frame);
				}
				catch(ClassNotFoundException|InstantiationException|IllegalAccessException|UnsupportedLookAndFeelException ex)
				{}
			}
		});
	
		miNimbus.addActionListener(new ActionListener()
		{
			public void actionPerformed(ActionEvent evt) 
			{
				try{
					UIManager.setLookAndFeel("javax.swing.plaf.nimbus.NimbusLookAndFeel");
					SwingUtilities.updateComponentTreeUI(frame);
				}
				catch(ClassNotFoundException|InstantiationException|IllegalAccessException|UnsupportedLookAndFeelException ex)
				{}
			}
		});
	
		miCross.addActionListener(new ActionListener()
		{
			public void actionPerformed(ActionEvent evt) 
			{
				try{
					UIManager.setLookAndFeel(UIManager.getCrossPlatformLookAndFeelClassName());
					SwingUtilities.updateComponentTreeUI(frame);
				}
				catch(ClassNotFoundException|InstantiationException|IllegalAccessException|UnsupportedLookAndFeelException ex)
				{}
			}
		});
		frame.addWindowListener(new WindowAdapter() {
			public void windowClosing(WindowEvent e) {
				if(db.closeConnection()){
					JOptionPane.showMessageDialog(frame, "You are Exiting and \n Connection is closed successfully.","INFORMATION", JOptionPane.INFORMATION_MESSAGE);;
				}
				frame.dispose();
			}
		});
	}
	public void addComponentsToFrame(){
		Navi.add(miHome);
		
		about.add(miabtproject);
		about.add(miabtstudent);
		
		lkfl.add(miCross);
		lkfl.add(miMotif);
		lkfl.add(miNimbus);
		
		menubar.add(Navi);
		menubar.add(about);
		menubar.add(lkfl);
		frame.setJMenuBar(menubar);
		
		p1.add(lblname);
		p1.add(tfname);
		
		p2.add(lbluname);
		p2.add(tfuname);
		
		p3.add(lblemail);
		p3.add(tfemail);
		
		p4.add(lblphno);
		p4.add(tfphno);
		
		p5.add(lblpass);
		p5.add(tfpass);
		
		p6.add(lblpass1);
		p6.add(tfpass1);
		
		p7.add(btnsubmit);
		
		frame.add(p1);
		frame.add(p2);
		frame.add(p3);
		frame.add(p4);
		frame.add(p5);
		frame.add(p6);
		frame.add(p7);
	}
}
